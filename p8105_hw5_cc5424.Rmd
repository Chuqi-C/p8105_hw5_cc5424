---
title: "p8105_hw5_cc5424"
author: "ChuqiChen"
date: "2025-11-13"
output: github_document
---
```{r}
library(tidyverse)
```

#problem1
```{r}
birthdays = sample(1:365, 5, replace = TRUE)

repeated_bday = length(unique(birthdays)) < 5

repeated_bday
```

```{r}
bday_sim = function(n_room) {
  
  birthdays = sample(1:365, n_room, replace = TRUE)

  repeated_bday = length(unique(birthdays)) < n_room

  repeated_bday
  
}

bday_sim(20)
```

```{r}
set.seed(123)

bday_sim_results = 
  expand_grid(
    bdays = 2:50, 
    iter = 1:10000
  ) |>
  mutate(
    result = map_lgl(bdays, bday_sim)
  ) |>
  group_by(bdays) |>
  summarize(prob_repeat = mean(result))
```

```{r}
bday_sim_results |> 
  ggplot(aes(x = bdays, y = prob_repeat)) + 
  geom_point() + 
  geom_line() +
  labs(
    title = "Probability of Shared Birthday vs. Group Size",
    x = "Group size (number of people)",
    y = "Probability of shared birthday"
  ) +
  theme_minimal(base_size = 14)
```

#problem2
```{r}

```

